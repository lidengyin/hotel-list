webpackJsonp([11],{K88u:function(t,e){},"wRC/":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("Xxa5"),r=n.n(a),o=n("NC6I"),i=n.n(o),s=n("D2Ra"),l=n("NYxO"),c=(n("kw8N"),Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t});function u(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(r,o){try{var i=e[r](o),s=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(s).then(function(t){a("next",t)},function(t){a("throw",t)});t(s)}("next")})}}var h={data:function(){return{loading:!1,pickerOptions:{shortcuts:[{text:"最近10分钟",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-6e5),t.$emit("pick",[n,e])}}]},time:"",Hotels:[],hotels:[],hotelLists:[],HotelInfoNum:0,pageSize:10,pageNum:0,lastRecordID:"0",recordId:["0","0"],extendedNode:["HotelStaticInfo.GeoInfo","HotelStaticInfo.NearbyPOIs","HotelStaticInfo.TransportationInfos","HotelStaticInfo.Brand","HotelStaticInfo.Policies","HotelStaticInfo.ImportantNotices","HotelStaticInfo.Facilities","HotelStaticInfo.Descriptions","HotelStaticInfo.Themes","HotelStaticInfo.ContactInfo","HotelStaticInfo.SupplierInfo","HotelStaticInfo.Pictures"]}},computed:c({},Object(l.c)(["primaryLangID"])),created:function(){var t=this.dateToStr(new Date),e=this.dateToStr(new Date((new Date).getTime()-6e5));this.time=[new Date(e.year,e.month,e.date,e.hour,e.minutes),new Date(t.year,t.month,t.date,t.hour,t.minutes)],this.toSearch("next")},mounted:function(){this.choiceMenuId("hotelChange")},methods:c({},Object(l.b)(["choiceMenuId"]),{returnHeaders:function(t){var e=(new Date).getTime()+"",n={timestamp:e,interfacekey:"15456a8b-f9b3-4e39-83cf-7186b9cb6336",requesttype:t,signature:i()(e+109+i()("15456a8b-f9b3-4e39-83cf-7186b9cb6336").toUpperCase()+104+t).toUpperCase(),"Content-Type":"application/json;charset=UTF-8",hoteltype:"3"};return n},handleCurrentChange:function(t){this.toSearch(t)},search:function(t){this.pageNum=0,this.lastRecordID="0",this.recordId=["0","0"],this.toSearch(t)},toSearch:function(t){var e=this.time;if(e&&e[1].getTime()-e[0].getTime()<=6e5){var n=this.dateToStr(e[0]),a=this.dateToStr(e[1]);n=n.year+"-"+n.month1+"-"+n.date+" "+n.hour+":"+n.minutes+":00",a=a.year+"-"+a.month1+"-"+a.date+" "+a.hour+":"+a.minutes+":00",this.reqHotelsChange(n,a,t)}else{var r="en"==this.primaryLangID?"The interval must not be greater than ten minutes":"时间间隔不能大于十分钟";this.message(r,"warning",1500)}},reqHotelsChange:function(t,e){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"next";return u(r.a.mark(function o(){var i,l,c,u,h,m,d,p,g,f;return r.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("last"==a?n.pageNum--:n.pageNum++,i=n.pageSize,l=n.pageNum,c=n.recordId,u=c[l],!(t&&e&&i)){r.next=14;break}return h=n.returnHeaders("GET_DIRECT_HOTELSTATICINFO_CHANGE"),m={start:t,end:e},n.loading=!0,r.next=9,Object(s.e)({dateTimeRage:m,pageSize:i,lastRecordId:u},h);case 9:d=r.sent,n.loading=!1,p=d.ResponseStatus,console.log(d),p&&0==p.Errors.length?(d.changeInfoList&&d.changeInfoList.changeInfo&&d.changeInfoList.changeInfo.length?n.hotels=d.changeInfoList.changeInfo:n.hotels=[],"next"==a&&d.lastRecordId&&void 0!=(g=d.lastRecordId)&&(n.recordId[n.pageNum+1]=g)):(n.hotels=[],f="en"==n.primaryLangID?"Failed to obtain incremental list, please refresh and try again":"获取酒店静态信息增量列表失败，请刷新重试",p.Errors[0].Message&&(f=p.Errors[0].Message),n.message(f,"error",1200));case 14:case"end":return r.stop()}},o,n)}))()},reqHotelsStatic:function(t){var e=this;return u(r.a.mark(function n(){var a,o,i,l,c,u,h;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.extendedNode,o=e.primaryLangID,!t){n.next=19;break}return e.loading=!0,i=e.returnHeaders("GET_HOTEL_STATICINFO"),l={hotelID:t},c={primaryLangID:o,extendedNodes:{extendedNode:a}},n.next=9,Object(s.j)({searchCandidate:l,settings:c},i);case 9:if(u=n.sent,h=u.ResponseStatus,e.HotelInfoNum++,!h||0!=h.Errors.length){n.next=16;break}return n.abrupt("return",u.hotelStaticInfo);case 16:return n.abrupt("return",[]);case 17:n.next=21;break;case 19:return e.HotelInfoNum++,n.abrupt("return",[]);case 21:case"end":return n.stop()}},n,e)}))()},formatterType:function(t,e){return t.changeType?"All"==t.changeType?"en"==this.primaryLangID?"Room & Hotel":"酒店及房型":"Room"==t.changeType?"en"==this.primaryLangID?"Room":"房型":"Hotel"==t.changeType?"en"==this.primaryLangID?"Hotel":"酒店":void 0:"-"},formatterOpenYear:function(t,e){return t.openYear?t.openYear.slice(0,10):"-"},message:function(t,e,n){this.$message({message:t,duration:n,type:e})},dateToStr:function(t){var e=t.getFullYear(),n=t.getMonth(),a=t.getMonth()+1,r=t.getDate(),o=t.getHours(),i=t.getMinutes();t.getSeconds();return n<10&&(n="0"+n),a<10&&(a="0"+a),r<10&&(r="0"+r),o<10&&(o="0"+o),i<10&&(i="0"+i),{year:e,month:n,date:r,hour:o,minutes:i,month1:a}},goToDetail:function(t){this.$router.push({name:"hotelDeatil",query:{hotelID:JSON.stringify(t.hotelID),hoteltype:JSON.stringify(1)}})}}),watch:{hotels:function(t,e){var n,a=this;t.length&&this.hotelLists.length!=t.length&&(this.HotelInfoNum=0,t.map((n=u(r.a.mark(function t(e){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.reqHotelsStatic(e.hotelID);case 2:n=t.sent,e.address=n.address,e.hotelName=n.hotelName,e.hotelEName=n.hotelEName,e.openYear=n.openYear,e.starRating=n.starRating;case 8:case"end":return t.stop()}},t,a)})),function(t){return n.apply(this,arguments)})),this.hotelLists=t)},HotelInfoNum:function(t,e){t==this.hotels.length&&(this.loading=!1)},primaryLangID:function(t,e){this.pickerOptions="en"==t?{shortcuts:[{text:"Last 10 minutes",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-6e5),t.$emit("pick",[n,e])}}]}:{shortcuts:[{text:"最近10分钟",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-6e5),t.$emit("pick",[n,e])}}]}}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"myHotelChange"},[n("div",{staticStyle:{padding:"20px"}},[n("h3",{staticClass:"myHotelList-bigTtitle"},[t._v(t._s(t.$t("m.HotelChangeLists"))+"：")]),t._v(" "),n("ul",{staticClass:"myHotelList-conditionUl"},[n("li",{staticClass:"myHotelList-conditionLi"},[n("span",{staticClass:"myHotelList-conditionSpan"},[t._v(t._s(t.$t("m.timeQuantum"))+"：")]),t._v(" "),n("el-date-picker",{attrs:{type:"datetimerange","picker-options":t.pickerOptions,"start-placeholder":"en"==t.primaryLangID?"Start":"开始日期","end-placeholder":"en"==t.primaryLangID?"End":"结束日期","range-separator":"en"==t.primaryLangID?"to":"至",align:"right"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1),t._v(" "),n("li",{staticClass:"myHotelList-conditionLi"},[n("el-button",{staticClass:"hotelButton",attrs:{type:"primary"},on:{click:function(e){return t.search("next")}}},[t._v(t._s(t.$t("m.search")))])],1)]),t._v(" "),n("div",{staticClass:"myHotelList-biaoGeDiv"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"lis",attrs:{"element-loading-text":"en"==t.primaryLangID?"Loading":"酒店数据加载中"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.hotelLists,stripe:"",border:"","empty-text":t.$t("m.emptyHotelChangeList")}},[n("el-table-column",{attrs:{label:t.$t("m.hotelID"),"min-width":"80",prop:"hotelID"}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("m.hotelName"),"min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("router-link",{attrs:{to:{name:"hotelDeatil",query:{hotelID:JSON.stringify(e.row.hotelID),hoteltype:JSON.stringify(1)}}}},[n("span",{staticClass:"overnone",staticStyle:{"text-align":"left!important",display:"inline-block",width:"100%"},attrs:{title:"en"==t.primaryLangID&&e.row.hotelEName||e.row.hotelName}},[t._v(t._s("en"==t.primaryLangID&&e.row.hotelEName||e.row.hotelName))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("m.starRating"),"min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-rate",{attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.row.starRating,callback:function(n){t.$set(e.row,"starRating",n)},expression:"scope.row.starRating"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("m.openYear"),"min-width":"120",formatter:t.formatterOpenYear}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("m.ChangeTheType"),"min-width":"120",formatter:t.formatterType}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("m.operate"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticClass:"hotelButton",attrs:{type:"text"},on:{click:function(n){return t.goToDetail(e.row)}}},[t._v(t._s(t.$t("m.viewDetails")))])]}}])})],1)],1)]),t._v(" "),!t.hotelLists.length||t.hotelLists.length<=t.pageSize&&1==t.pageNum?t._e():n("div",{staticClass:"myPages"},[n("el-row",[n("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left",plain:"",disabled:"0"==t.recordId[t.pageNum]},on:{click:function(e){return t.handleCurrentChange("last")}}},[t._v(t._s(t.$t("m.last")))]),t._v(" "),n("el-button",{attrs:{type:"primary",plain:"",disabled:t.recordId[t.pageNum+1].slice(t.recordId[t.pageNum+1].indexOf("$")+1,t.recordId[t.pageNum+1].length)==t.pageSize},on:{click:function(e){return t.handleCurrentChange("next")}}},[t._v(t._s(t.$t("m.next"))),n("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)],1)])])},staticRenderFns:[]};var d=n("VU/8")(h,m,!1,function(t){n("K88u")},null,null);e.default=d.exports}});